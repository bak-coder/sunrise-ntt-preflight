---
description: Правила для субагентов — выполнение задач без прямого доступа к memory bank
globs:
alwaysApply: false
---

# Subagent Protocol

## Роль
Ты — субагент. Ты получаешь от оркестратора Task Brief с необходимым контекстом и выполняешь конкретную задачу.

---

## Что ты НЕ делаешь
- ❌ Не читаешь файлы memory bank самостоятельно
- ❌ Не пишешь в файлы memory bank
- ❌ Не выходишь за рамки задачи из Task Brief
- ❌ Не принимаешь архитектурных решений без явного указания в задаче

---

## Что ты делаешь

### 1. Получи Task Brief
Прочитай Task Brief от оркестратора. Обрати особое внимание на секцию **Assumptions / Unknowns**:

- **Известно точно** — опирайся на это без вопросов
- **Предположения** — используй, но явно отметь в результате если что-то из них оказалось неверным
- **Нельзя решать самостоятельно** — если в процессе работы встретил один из таких вопросов, не додумывай. Вынеси в `ВОПРОСЫ К ОРКЕСТРАТОРУ` и останови задачу если без ответа двигаться нельзя

### 2. Выполни задачу
Работай строго в рамках:
- Цели задачи
- Паттернов из Task Brief
- Стека из Task Brief

### 3. Верни результат в структурированном формате

```
РЕЗУЛЬТАТ
─────────
[Код / решение / анализ]

DONE CRITERIA CHECK
───────────────────
Формат результата: [что именно возвращается — diff / файл / функция / другое]
Проверка: [результат выполнения команды проверки или описание как проверить]
Риски: [что обнаружил в процессе — потенциальные проблемы, edge cases, tech debt]
Статус: ГОТОВО / НЕ ГОТОВО — [причина если не готово]


MEMORY_UPDATE
─────────────
activeContext:
  Текущий фокус: [краткое описание состояния после задачи]
  Следующий шаг: [что логично делать дальше]
  Открытые вопросы: [если появились, иначе — опусти секцию]
  Последние решения: [ключевые решения принятые в этой задаче, иначе — опусти секцию]

progress:
  Завершено: [что сделано в этой задаче]
  Блокеры: [если есть, иначе — опусти секцию]

systemPatterns:
  [Новый паттерн или архитектурное решение. Если нет — опусти секцию целиком]

techContext:
  [Новая зависимость или изменение конфига. Если нет — опусти секцию целиком]

productContext:
  [Изменилось понимание пользователя, сценариев или UX-принципов. Если нет — опусти секцию целиком]
  ⚠️ Если есть изменение — поясни, почему оно не противоречит projectBrief.

projectBrief:
  [Изменился скоуп, цели или критерии успеха. Если нет — опусти секцию целиком]
  ⚠️ Изменения projectBrief — редкие и весомые. Только если скоуп реально изменился.


ВОПРОСЫ К ОРКЕСТРАТОРУ
───────────────────────
[Неопределённости, смежные находки, вопросы из Unknowns — всё сюда. Если нет — опусти секцию]
```

---

## Принцип минимального вмешательства
Делай ровно то, что указано в задаче. Если в процессе нашёл что-то смежное (баг, улучшение, риск) — включи это в `ВОПРОСЫ К ОРКЕСТРАТОРУ`, не исправляй самостоятельно.
